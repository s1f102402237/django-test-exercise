{% load static %}
<!DOCTYPE html>
<html lang="ja">
    <head>
        <title>To Do Application</title>
        <meta charset="UTF-8">
        <meta name="author" content="INIAD">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="{% static 'css/index.css' %}">
    </head>

    <body>
        <div class="main-layout-container">

            <div class="left-column">
                <h1>Sample To Do Application</h1>
                <p>You can submit tasks from the following form.</p>

                <form action="{% url 'index' %}" method="post" onsubmit="return validateForm();">
                    {% csrf_token %}
                    <div>
                        <label for="titleInput">Title</label><br>
                        <input id="titleInput" name="title" type="text" placeholder="Input title">
                    </div>
                    <div>
                        <label for="dueInput">Due at:</label><br>
                        <input id="dueInput" name="due_at" type="datetime-local">
                    </div>
                    <div>
                        <button type="submit">Submit</button>
                    </div>
                </form>

                <div class="sort-links">
                    <a href="{% url 'index' %}?order=due">Sort by Due Date</a> |
                    <a href="{% url 'index' %}?order=post">Sort by Posted Date</a>
                </div>
            </div>

            <div class="right-column">
                <div class="task-list-container">
                    {% for task in tasks %}
                    <div class="task-card">
                        <h2><a href="{% url 'detail' task.id %}">{{ task.title }}</a></h2>
                        <ul>
                            <li>Posted at: {{ task.posted_at }}</li>
                            {% if task.due_at %}
                            <li>Due at: {{ task.due_at }}</li>
                            {% endif %}
                            {% if task.completed %}
                            <li>Status: <span style="color: #2ecc71;">Completed</span></li>
                            {% else %}
                            <li>Status: <span style="color: #e74c3c;">Not Completed</span></li>
                            {% endif %}
                        </ul>
                    </div>
                    {% endfor %}
                </div>
            </div>

        </div>

        <script>
            function validateForm() {
                const title = document.getElementById('titleInput').value;
                const dueAt = document.getElementById('dueInput').value;

                // タイトルが空欄かチェック
                if (title.trim() === "") {
                    alert("タイトルは必須です。");
                    return false; // falseを返すとフォームの送信を中止します
                }

                // 締め切り日が空欄かチェック
                if (dueAt === "") {
                    alert("締め切り日は必須です。");
                    return false; // 送信を中止
                }

                // すべてのチェックを通過したらtrueを返す
                return true;
            }
        </script>
    </body>

</html>